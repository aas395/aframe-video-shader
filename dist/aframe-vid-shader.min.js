!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e,t){return{status:"error",src:t,message:e,timestamp:Date.now()}}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=n(2);if("undefined"==typeof AFRAME)throw"Component attempted to register before AFRAME was available.";var o=AFRAME.utils.srcLoader.parseUrl,u=AFRAME.utils.debug;u.enable("shader:video:warn");var s=u("shader:video:warn"),d=u("shader:video:debug"),c={};AFRAME.registerShader("video",{schema:{color:{type:"color"},fog:{"default":!0},src:{"default":null},autoplay:{"default":!0},preload:{"default":!0},muted:{"default":!0},loop:{"default":!0},fps:{"default":60},volume:{"default":void 0}},init:function(e){return d("init",e),this.__cnv=document.createElement("canvas"),this.__cnv.width=2,this.__cnv.height=2,this.__ctx=this.__cnv.getContext("2d"),this.__texture=new THREE.Texture(this.__cnv),this.__reset(),this.material=new THREE.MeshBasicMaterial({map:this.__texture}),this.el.sceneEl.addBehavior(this),this.material},update:function(e){return d("update",e),this.__updateMaterial(e),this.__updateTexture(e),this.material},tick:function(e){d("tick"),!this.__paused&&this.__canvasVideo&&this.__canvasVideo.tick()},__updateMaterial:function(e){var t=this.material,n=this.__getMaterialData(e);Object.keys(n).forEach(function(e){t[e]=n[e]})},__getMaterialData:function(e){return{fog:e.fog,color:new THREE.Color(e.color)}},__setTexure:function(e){d("__setTexure",e),"error"===e.status?(s("Error: "+e.message+"\nsrc: "+e.src),this.__reset()):"success"===e.status&&e.src!==this.__textureSrc&&(this.__reset(),this.__ready(e))},__updateTexture:function(e){var t=e.src,n=e.autoplay,i=(e.muted,e.volume,e.loop,e.fps);"boolean"==typeof n?this.__autoplay=n:"undefined"==typeof n&&(this.__autoplay=this.schema.autoplay["default"]),this.__autoplay&&this.__frames&&this.play(),"boolean"==typeof preload?this.__preload=preload:"undefined"==typeof preload&&(this.__preload=this.schema.preload["default"]),this.__muted=!0,this.__volume=void 0,this.__loop=!0,this.__fps=i||this.schema.fps["default"],t?this.__validateSrc(t,this.__setTexure.bind(this)):this.__reset()},__validateSrc:function(e,t){var n=o(e);if(n)return void this.__getVideoSrc(n,t);var a=void 0,u=this.__validateAndGetQuerySelector(e);if(u&&"object"===("undefined"==typeof u?"undefined":r(u))){if(u.error)a=u.error;else{var s=u.tagName.toLowerCase();"video"===s?(e=u.src,this.__getVideoSrc(e,t,u)):a="img"===s?"For <"+s+"> element, please use `shader:flat`":"For <"+s+"> element, please use `aframe-html-shader`"}a&&!function(){var n=c[e],r=i(a,e);n&&n.callbacks?n.callbacks.forEach(function(e){return e(r)}):t(r),c[e]=r}()}},__getVideoSrc:function(e,t,n){if(e!==this.__textureSrc){var o=c[e];if(o&&o.callbacks){if(o.src)return void t(o);if(o.callbacks)return void o.callbacks.push(t)}else o=c[e]={callbacks:[]},o.callbacks.push(t);var u={autoplay:this.__autoplay,preload:this.__preload,muted:this.__muted,volume:this.__volume,loop:this.__loop,fps:this.__fps,canvas:this.__cnv,context:this.__ctx,render:this.__render.bind(this),element:n};(0,a.inlineVideo)(e,u,function(t,n){if(t){var a=function(){var n=i(t,e);return o.callbacks&&(o.callbacks.forEach(function(e){return e(n)}),c[e]=n),{v:void 0}}();if("object"===("undefined"==typeof a?"undefined":r(a)))return a.v}var u={status:"success",src:e,canvasVideo:n,timestamp:Date.now()};o.callbacks&&(o.callbacks.forEach(function(e){return e(u)}),c[e]=u)})}},__validateAndGetQuerySelector:function(e){try{var t=document.querySelector(e);return t?t:{error:"No element was found matching the selector"}}catch(n){return{error:"no valid selector"}}},__addPublicFunctions:function(){this.el.shader={play:this.play.bind(this),pause:this.pause.bind(this),togglePlayback:this.togglePlayback.bind(this),paused:this.paused.bind(this),nextFrame:this.nextFrame.bind(this)}},pause:function(){d("pause"),this.__paused=!0,this.__canvasVideo&&this.__canvasVideo.pause()},play:function(){d("play"),this.__paused=!1,this.__canvasVideo&&this.__canvasVideo.play()},togglePlayback:function(){this.paused()?this.play():this.pause()},paused:function(){return this.__paused},__clearCanvas:function(){this.__ctx.clearRect(0,0,this.__width,this.__height),this.__texture.needsUpdate=!0},__draw:function(e){this.__ctx.drawImage(e,0,0,this.__width,this.__height),this.__texture.needsUpdate=!0},__render:function(e){this.__clearCanvas(),this.__draw(e)},__ready:function(e){var t=e.src,n=e.canvasVideo;d("__ready"),this.__textureSrc=t,this.__width=this.__cnv.width,this.__height=this.__cnv.height,this.__canvasVideo=n,this.__autoplay?this.play():this.pause()},__reset:function(){this.pause(),this.__clearCanvas(),this.__textureSrc=null}})},function(e,t){function n(){d=!1,o.length?s=o.concat(s):c=-1,s.length&&i()}function i(){if(!d){var e=setTimeout(n);d=!0;for(var t=s.length;t;){for(o=s,s=[];++c<t;)o&&o[c].run();c=-1,t=s.length}o=null,d=!1,clearTimeout(e)}}function r(e,t){this.fun=e,this.array=t}function a(){}var o,u=e.exports={},s=[],d=!1,c=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new r(e,t)),1!==s.length||d||setTimeout(i,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=a,u.addListener=a,u.once=a,u.off=a,u.removeListener=a,u.removeAllListeners=a,u.emit=a,u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var r=n(9),a=i(r),o=n(3),u=i(o),s=n(8),d=i(s),c=n(6),l=i(c),f=AFRAME.utils.debug;f.enable("shader:video:warn");var v=f("shader:video:warn"),h=(f("shader:video:debug"),/i(Pad|Phone)/i.test(navigator.userAgent));t.inlineVideo=function(e,t,n){function i(e){if(e)return v(e),void n("Somehow there is error during loading video");m.width=THREE.Math.nearestPowerOfTwo(y.videoWidth),m.height=THREE.Math.nearestPowerOfTwo(y.videoHeight),h&&(y.addEventListener("timeupdate",c,!1),E&&E.addEventListener("ended",function(){f&&(E.currentTime=0)},!1)),w=y.duration,(0,l["default"])(c);var t={play:r,pause:o,tick:s,canvas:m,video:y,audio:E,fallback:h};n(null,t)}function r(){b=(0,d["default"])(),E&&E.play(),h||y.play()}function o(){E&&E.pause(),h||y.pause()}function s(){if(!h)return c();var e=(0,d["default"])();x=(e-b)/1e3,x>=1e3/p/1e3&&(h&&(E?y.currentTime=E.currentTime:y.currentTime=y.currentTime+x),b=e),h&&!E&&Math.abs(y.currentTime-w)<.1&&f&&(y.currentTime=0)}function c(){_(y)}var f=(t.autoplay,t.preload,t.muted,t.loop),p=t.fps,m=t.canvas,_=(t.context,t.render),g=t.element,y=g||document.createElement("video"),b=(0,d["default"])(),x=0,w=1/0,E=void 0;h?(t.muted||(E=document.createElement("audio"),t.autoplay=!1),(0,a["default"])([function(n){u["default"].video(e,Object.assign({},t,{muted:!0,element:y}),n)},function(n){u["default"].audio(e,Object.assign({},t,{element:E}),n)}],i)):u["default"].video(e,Object.assign({},t,{element:y}),i)}},function(e,t,n){(function(t){"use strict";function i(){}function r(e,n,r,o){function u(){d.addEventListener("canplay",function(){o(null,d),o=i},!1),d.addEventListener("error",function(e){o(e),o=i},!1),d.addEventListener("readystatechange",s,!1),d.load(),s()}function s(){d.readyState>d.HAVE_FUTURE_DATA&&(o(null,d),o=i)}"function"==typeof r&&(o=r,r={}),o=o||i,r=r||{},Array.isArray(n)||(n=[n]);var d=r.element||document.createElement(e);return r.loop&&d.setAttribute("loop",!0),r.muted&&d.setAttribute("muted","muted"),r.autoplay&&d.setAttribute("autoplay","autoplay"),r.preload&&d.setAttribute("preload",r.preload),"undefined"!=typeof r.volume&&d.setAttribute("volume",r.volume),d.setAttribute("crossorigin","anonymous"),d.setAttribute("webkit-playsinline",""),n.forEach(function(e){d.appendChild(a(e))}),t.nextTick(u),d}var a=n(4);e.exports.video=r.bind(null,"video"),e.exports.audio=r.bind(null,"audio")}).call(t,n(1))},function(e,t,n){"use strict";function i(e,t){var n=document.createElement("source");return n.src=e,t||(t=r(e)),n.type=t,n}function r(e){var t=a(e);if(0===t.indexOf(".")&&(t=u[t.substring(1).toLowerCase()]),!t)throw new TypeError("could not determine mime-type from source: "+e);return t}var a=n(10).extname,o=n(5),u={};Object.keys(o).forEach(function(e){var t=o[e];t.forEach(function(t){u[t]=e})}),e.exports=i},function(e,t){e.exports={"audio/adpcm":["adp"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mp4":["mp4a","m4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/vnd.dece.audio":["uva","uvva"],"audio/vnd.digital-winds":["eol"],"audio/vnd.dra":["dra"],"audio/vnd.dts":["dts"],"audio/vnd.dts.hd":["dtshd"],"audio/vnd.lucent.voice":["lvp"],"audio/vnd.ms-playready.media.pya":["pya"],"audio/vnd.nuera.ecelp4800":["ecelp4800"],"audio/vnd.nuera.ecelp7470":["ecelp7470"],"audio/vnd.nuera.ecelp9600":["ecelp9600"],"audio/vnd.rip":["rip"],"audio/webm":["weba"],"audio/x-aac":["aac"],"audio/x-aiff":["aif","aiff","aifc"],"audio/x-caf":["caf"],"audio/x-flac":["flac"],"audio/x-matroska":["mka"],"audio/x-mpegurl":["m3u"],"audio/x-ms-wax":["wax"],"audio/x-ms-wma":["wma"],"audio/x-pn-realaudio":["ram","ra"],"audio/x-pn-realaudio-plugin":["rmp"],"audio/x-wav":["wav"],"audio/xm":["xm"],"video/3gpp":["3gp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/jpeg":["jpgv"],"video/jpm":["jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/vnd.dece.hd":["uvh","uvvh"],"video/vnd.dece.mobile":["uvm","uvvm"],"video/vnd.dece.pd":["uvp","uvvp"],"video/vnd.dece.sd":["uvs","uvvs"],"video/vnd.dece.video":["uvv","uvvv"],"video/vnd.dvb.file":["dvb"],"video/vnd.fvt":["fvt"],"video/vnd.mpegurl":["mxu","m4u"],"video/vnd.ms-playready.media.pyv":["pyv"],"video/vnd.uvvu.mp4":["uvu","uvvu"],"video/vnd.vivo":["viv"],"video/webm":["webm"],"video/x-f4v":["f4v"],"video/x-fli":["fli"],"video/x-flv":["flv"],"video/x-m4v":["m4v"],"video/x-matroska":["mkv","mk3d","mks"],"video/x-mng":["mng"],"video/x-ms-asf":["asf","asx"],"video/x-ms-vob":["vob"],"video/x-ms-wm":["wm"],"video/x-ms-wmv":["wmv"],"video/x-ms-wmx":["wmx"],"video/x-ms-wvx":["wvx"],"video/x-msvideo":["avi"],"video/x-sgi-movie":["movie"],"video/x-smv":["smv"]}},function(e,t,n){(function(t){for(var i=n(7),r="undefined"==typeof window?t:window,a=["moz","webkit"],o="AnimationFrame",u=r["request"+o],s=r["cancel"+o]||r["cancelRequest"+o],d=0;!u&&d<a.length;d++)u=r[a[d]+"Request"+o],s=r[a[d]+"Cancel"+o]||r[a[d]+"CancelRequest"+o];if(!u||!s){var c=0,l=0,f=[],v=1e3/60;u=function(e){if(0===f.length){var t=i(),n=Math.max(0,v-(t-c));c=n+t,setTimeout(function(){var e=f.slice(0);f.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(c)}catch(n){setTimeout(function(){throw n},0)}},Math.round(n))}return f.push({handle:++l,callback:e,cancelled:!1}),l},s=function(e){for(var t=0;t<f.length;t++)f[t].handle===e&&(f[t].cancelled=!0)}}e.exports=function(e){return u.call(r,e)},e.exports.cancel=function(){s.apply(r,arguments)},e.exports.polyfill=function(){r.requestAnimationFrame=u,r.cancelAnimationFrame=s}}).call(t,function(){return this}())},function(e,t,n){(function(t){(function(){var n,i,r;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:"undefined"!=typeof t&&null!==t&&t.hrtime?(e.exports=function(){return(n()-r)/1e6},i=t.hrtime,n=function(){var e;return e=i(),1e9*e[0]+e[1]},r=n()):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)}).call(t,n(1))},function(e,t){(function(t){e.exports=t.performance&&t.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(t,function(){return this}())},function(e,t,n){(function(t){e.exports=function(e,n){function i(e){function i(){n&&n(e,a),n=null}s?t.nextTick(i):i()}function r(e,t,n){a[e]=n,(0===--o||t)&&i(t)}var a,o,u,s=!0;Array.isArray(e)?(a=[],o=e.length):(u=Object.keys(e),a={},o=u.length),o?u?u.forEach(function(t){e[t](function(e,n){r(t,e,n)})}):e.forEach(function(e,t){e(function(e,n){r(t,e,n)})}):i(null),s=!1}}).call(t,n(1))},function(e,t,n){(function(e){function n(e,t){for(var n=0,i=e.length-1;i>=0;i--){var r=e[i];"."===r?e.splice(i,1):".."===r?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function i(e,t){if(e.filter)return e.filter(t);for(var n=[],i=0;i<e.length;i++)t(e[i],i,e)&&n.push(e[i]);return n}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,a=function(e){return r.exec(e).slice(1)};t.resolve=function(){for(var t="",r=!1,a=arguments.length-1;a>=-1&&!r;a--){var o=a>=0?arguments[a]:e.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,r="/"===o.charAt(0))}return t=n(i(t.split("/"),function(e){return!!e}),!r).join("/"),(r?"/":"")+t||"."},t.normalize=function(e){var r=t.isAbsolute(e),a="/"===o(e,-1);return e=n(i(e.split("/"),function(e){return!!e}),!r).join("/"),e||r||(e="."),e&&a&&(e+="/"),(r?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(i(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var r=i(e.split("/")),a=i(n.split("/")),o=Math.min(r.length,a.length),u=o,s=0;o>s;s++)if(r[s]!==a[s]){u=s;break}for(var d=[],s=u;s<r.length;s++)d.push("..");return d=d.concat(a.slice(u)),d.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=a(e),n=t[0],i=t[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},t.basename=function(e,t){var n=a(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return a(e)[3]};var o="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return 0>t&&(t=e.length+t),e.substr(t,n)}}).call(t,n(1))}]);